# Dice（骰子）游戏详细设计文档

## 配置文件

### 游戏配置 (`configs/games/dice.json`)
```json
{
  "gameId": "inhousegame:dice",
  "status": "active",
  "gameParameters": {
    "rollNumberRange": {
      "min": 4.0,
      "max": 96.0
    },
    "defaultTarget": 50.0
  },
  "rtp": 97.0
}
```

### 配置说明
- **gameId**: 游戏唯一标识符，格式为 `"inhousegame:dice"`
- **status**: 游戏状态（`active` 启用，`disabled` 禁用）
- **gameParameters**: 游戏核心参数
  - **rollNumberRange**: 有效的目标值范围
    - `min`: 最小目标值（4.0），确保赔率始终大于 1
    - `max`: 最大目标值（96.0），确保赔率始终大于 1
  - **defaultTarget**: 默认目标值（50.0）
- **rtp**: 理论回报率（97%）

### 配置加载
- **加载时机**: 服务器启动时，GameRegistry 自动从 `configs/games/` 目录加载所有 `.json` 配置文件
- **使用方式**: 游戏服务通过 `gameRegistry.GetGame("inhousegame:dice")` 获取配置
- **投注限额**: 从 `configs/currencies.json` 自动生成 BetInfo，Dice 游戏使用自定义生成逻辑

## 赔率计算公式

Dice游戏支持两种玩法模式：

1. **Roll Over（大于模式）**
   - 玩家预测骰子结果将大于目标值
   - 赔率公式：`赔率 = 100 ÷ (100 - 目标值) × 0.97`

2. **Roll Under（小于等于模式）**  
   - 玩家预测骰子结果将小于或等于目标值
   - 赔率公式：`赔率 = 100 ÷ 目标值 × 0.97`

**公式说明：**
- 目标值范围：1-99
- 0.97系数：代表3%的庄家优势
- 赔率结果：玩家获胜时的倍数

## 胜率计算

- **Roll Over胜率**：`(100 - 目标值) ÷ 100`
- **Roll Under胜率**：`目标值 ÷ 100`

## 赔率对照表

| 玩法模式 | 目标值 | 获胜概率 | 理论赔率 | 实际赔率 |
|----------|--------|----------|----------|----------|
| Roll Under | 10 | 10% | 10.00× | 9.70× |
| Roll Under | 25 | 25% | 4.00× | 3.88× |
| Roll Under | 50 | 50% | 2.00× | 1.94× |
| Roll Under | 75 | 75% | 1.33× | 1.29× |
| Roll Under | 90 | 90% | 1.11× | 1.08× |
| Roll Over | 10 | 90% | 1.11× | 1.08× |
| Roll Over | 25 | 75% | 1.33× | 1.29× |
| Roll Over | 50 | 50% | 2.00× | 1.94× |
| Roll Over | 75 | 25% | 4.00× | 3.88× |
| Roll Over | 90 | 10% | 10.00× | 9.70× |

## 输赢判定规则

- **Roll Over**：骰子结果严格大于目标值时获胜
- **Roll Under**：骰子结果小于或等于目标值时获胜

**特别说明：**
- Roll Under 模式包含"等于"的情况，符合行业标准
- 这种设计确保了数学期望的准确性和公平性

## 前端实现建议

前端开发时可以：
1. 实时计算并显示当前目标值对应的赔率
2. 显示潜在赢利金额（投注金额 × 赔率）
3. 显示当前获胜概率百分比
4. 使用滑块或输入框让玩家调整目标值